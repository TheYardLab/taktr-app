"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[993],{2993:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var s=a(5893),r=a(7294),n=a(252),l=a(9828);let i=e=>{if(!e)return null;let t=new Date(e);return isNaN(t.getTime())?null:t},d=e=>"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0"));function c(e){let{projectId:t}=e,[a,c]=(0,r.useState)([]);(0,r.useEffect)(()=>{if(!t)return;let e=(0,l.hJ)(n.db,"projects",t,"tasks"),a=(0,l.cf)(e,e=>{let t=[];e.forEach(e=>{let a=e.data();t.push({id:e.id,name:a.name||a.task||"",startDate:(a.startDate||a.start||"").split("T")[0]||"",endDate:(a.endDate||a.finish||"").split("T")[0]||"",status:a.status||"",trade:a.trade||""})}),c(t)});return()=>a()},[t]);let[o,u]=(0,r.useMemo)(()=>{let e=null,t=null;for(let s of a){let a=i(s.startDate),r=i(s.endDate);a&&(!e||a<e)&&(e=a),r&&(!t||r>t)&&(t=r)}if(!e||!t){let e=new Date,t=new Date;return t.setDate(t.getDate()+14),[e,t]}return[e,t]},[a]),h=(0,r.useMemo)(()=>{let e=[],t=new Date(o);t.setHours(0,0,0,0);let a=new Date(u);for(a.setHours(0,0,0,0);t<=a;)e.push(new Date(t)),t.setDate(t.getDate()+1);return e},[o,u]),x=(0,r.useMemo)(()=>[...a].sort((e,t)=>(e.startDate||"").localeCompare(t.startDate||"")),[a]),m=e=>{let t=i(e);return t?18*Math.max(0,Math.round((t.getTime()-new Date(d(o)).getTime())/864e5)):0},p=(e,t)=>{let a=i(e),s=i(t);return a&&s?18*Math.max(1,Math.round((s.getTime()-a.getTime())/864e5)+1):18};return(0,s.jsxs)("div",{className:"rounded border bg-white",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between border-b px-3 py-2",children:[(0,s.jsx)("div",{className:"font-semibold",children:"Gantt"}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:[d(o)," → ",d(u)," • ",x.length," tasks"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-[260px_1fr]",children:[(0,s.jsxs)("div",{className:"border-r",children:[(0,s.jsx)("div",{className:"sticky top-0 z-10 bg-white border-b px-3 py-2 text-xs font-semibold",children:"Task"}),(0,s.jsx)("div",{children:x.map(e=>(0,s.jsxs)("div",{className:"border-b px-3 py-2 text-sm",children:[(0,s.jsx)("div",{className:"truncate",children:e.name||(0,s.jsx)("span",{className:"text-gray-400",children:"—"})}),(0,s.jsxs)("div",{className:"text-[11px] text-gray-500",children:[e.trade?"".concat(e.trade," • "):"",e.status||""]})]},e.id))})]}),(0,s.jsxs)("div",{className:"overflow-x-auto",children:[(0,s.jsx)("div",{className:"sticky top-0 z-10 flex border-b bg-white",children:h.map((e,t)=>(0,s.jsxs)("div",{className:"border-r px-2 py-2 text-center text-[10px]",style:{width:18},title:d(e),children:[e.getMonth()+1,"/",e.getDate()]},t))}),(0,s.jsx)("div",{children:x.map(e=>(0,s.jsx)("div",{className:"relative border-b",style:{height:28},children:(0,s.jsx)("div",{className:"absolute top-1 h-5 rounded bg-blue-500/80",style:{left:m(e.startDate),width:p(e.startDate,e.endDate),minWidth:10},title:"".concat(e.name,"\n").concat(e.startDate||"?"," → ").concat(e.endDate||"?")})},e.id))})]})]})]})}}}]);