"use strict";exports.id=403,exports.ids=[403],exports.modules={7403:(e,t,n)=>{n.a(e,async(e,a)=>{try{n.r(t),n.d(t,{default:()=>m});var s=n(997),r=n(6689),l=n(252),i=n(1492),o=e([l,i]);function d(e){if(e){if("string"==typeof e){let t=new Date(e);return Number.isNaN(t.getTime())?void 0:t}if(e instanceof Date)return e;if("number"==typeof e.seconds)return new Date(1e3*e.seconds)}}function h(e){let t=new Date(e);return t.setHours(0,0,0,0),t}function x(e){return h(e).toISOString().slice(0,10)}function m({tasks:e,projectId:t}){let[n,a]=(0,r.useState)([]),l=e??n,{days:i,planned:o,actual:m,maxY:c}=(0,r.useMemo)(()=>{if(!l||0===l.length)return{days:[],planned:[],actual:[],maxY:0};let e=[],t=[];for(let n of l){let a=d(n.endDate??n.end);a&&e.push(h(a));let s=(n.status||"").toLowerCase(),r="done"===s||"completed"===s,l=d(n.actualEnd)??(r?a:void 0);l&&t.push(h(l))}if(0===e.length&&0===t.length)return{days:[],planned:[],actual:[],maxY:0};e.sort((e,t)=>e.getTime()-t.getTime()),t.sort((e,t)=>e.getTime()-t.getTime());let n=new Date(Math.min(e.length?e[0].getTime():1/0,t.length?t[0].getTime():1/0)),a=new Date(Math.max(e.length?e[e.length-1].getTime():-1/0,t.length?t[t.length-1].getTime():-1/0));if(!(n.getTime()<=a.getTime()))return{days:[],planned:[],actual:[],maxY:0};let s=[],r=h(n);for(;r<=a;)s.push(new Date(r)),r=function(e,t){let n=new Date(e);return n.setDate(n.getDate()+1),n}(r,0);let i=new Map;for(let t of e){let e=x(t);i.set(e,(i.get(e)||0)+1)}let o=new Map;for(let e of t){let t=x(e);o.set(t,(o.get(t)||0)+1)}let m=[],c=[],u=0,g=0;for(let e of s){let t=x(e);u+=i.get(t)||0,g+=o.get(t)||0,m.push(u),c.push(g)}let f=Math.max(m.at(-1)||0,c.at(-1)||0);return{days:s,planned:m,actual:c,maxY:f}},[l]);if(!e&&!t)return s.jsx("div",{className:"text-sm text-gray-500",children:"Provide tasks or a projectId to render the S-Curve."});if(!l||0===l.length)return s.jsx("div",{className:"rounded border border-dashed p-4 text-sm text-gray-500",children:"No tasks with finish dates found. Import a schedule or add tasks to see the S-Curve."});let u={top:16,right:16,bottom:36,left:44},g=900-u.left-u.right,f=320-u.top-u.bottom,p=e=>e/Math.max(1,i.length-1)*g,j=e=>f-e/Math.max(1,c)*f,y=0===o.length?"":o.map((e,t)=>`${0===t?"M":"L"} ${p(t).toFixed(2)} ${j(e).toFixed(2)}`).join(" "),b=0===m.length?"":m.map((e,t)=>`${0===t?"M":"L"} ${p(t).toFixed(2)} ${j(e).toFixed(2)}`).join(" "),v=Math.min(8,Math.max(1,i.length-1));return(0,s.jsxs)("div",{className:"overflow-auto rounded border bg-white p-3",children:[(0,s.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"S-Curve (Cumulative Planned vs Actual)"}),(0,s.jsxs)("div",{className:"flex items-center gap-3 text-xs",children:[(0,s.jsxs)("span",{className:"inline-flex items-center gap-1",children:[s.jsx("span",{className:"inline-block h-2 w-4 rounded-sm bg-blue-600"})," Planned"]}),(0,s.jsxs)("span",{className:"inline-flex items-center gap-1",children:[s.jsx("span",{className:"inline-block h-2 w-4 rounded-sm bg-green-600"})," Actual"]})]})]}),s.jsx("svg",{width:900,height:320,role:"img","aria-label":"S-Curve chart",children:(0,s.jsxs)("g",{transform:`translate(${u.left},${u.top})`,children:[Array.from({length:6},(e,t)=>{let n=t/5*c,a=j(n);return(0,s.jsxs)("g",{children:[s.jsx("line",{x1:0,x2:g,y1:a,y2:a,stroke:"#e5e7eb"}),s.jsx("text",{x:-8,y:a,textAnchor:"end",dominantBaseline:"middle",fontSize:"10",fill:"#6b7280",children:Math.round(n)})]},`y-${t}`)}),Array.from({length:v+1},(e,t)=>{let n=Math.round(t/v*(i.length-1)),a=i[n],r=p(n);return(0,s.jsxs)("g",{children:[s.jsx("line",{x1:r,x2:r,y1:0,y2:f,stroke:"#f3f4f6"}),s.jsx("text",{x:r,y:f+16,textAnchor:"middle",fontSize:"10",fill:"#6b7280",children:a.toLocaleDateString()})]},`x-${t}`)}),s.jsx("line",{x1:0,x2:g,y1:f,y2:f,stroke:"#9ca3af"}),s.jsx("line",{x1:0,x2:0,y1:0,y2:f,stroke:"#9ca3af"}),s.jsx("path",{d:y,fill:"none",stroke:"#2563eb",strokeWidth:2}),s.jsx("path",{d:b,fill:"none",stroke:"#16a34a",strokeWidth:2})]})})]})}[l,i]=o.then?(await o)():o,a()}catch(e){a(e)}})}};