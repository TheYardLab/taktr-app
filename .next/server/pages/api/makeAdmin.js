"use strict";(()=>{var e={};e.id=123,e.ids=[123],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3263:e=>{e.exports=import("firebase-admin/app")},9637:e=>{e.exports=import("firebase-admin/auth")},2929:e=>{e.exports=import("firebase-admin/firestore")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},8933:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{config:()=>E,default:()=>l,routeModule:()=>c});var i=r(1802),a=r(7153),o=r(6249),s=r(9106),u=e([s]);s=(u.then?(await u)():u)[0];let l=(0,o.l)(s,"default"),E=(0,o.l)(s,"config"),c=new i.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/makeAdmin",pathname:"/api/makeAdmin",bundlePath:"",filename:""},userland:s});n()}catch(e){n(e)}})},535:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{default:()=>E});var i=r(3263),a=r(2929),o=r(9637),s=e([i,a,o]);function u(e){if(!e)return null;try{let t=Buffer.from(e,"base64").toString("utf8");return JSON.parse(t)}catch{return null}}[i,a,o]=s.then?(await s)():s;let l="__taktr_admin__",E=(()=>{let e=globalThis;return e[l]||(e[l]=function(){let e=(0,i.cert)(function(){let e=process.env.GOOGLE_APPLICATION_CREDENTIALS_JSON,t=function(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}(e)||u(e||"");if(t&&t.client_email&&t.private_key){let e=t.project_id||process.env.FIREBASE_PROJECT_ID,r=t.client_email,n=String(t.private_key).replace(/\\n/g,"\n");if(e&&r&&n)return{projectId:e,clientEmail:r,privateKey:n}}let r=process.env.FIREBASE_SERVICE_ACCOUNT_BASE64||process.env.FIREBASE_PRIVATE_KEY_BASE64,n=u(r||"");if(n&&n.client_email&&n.private_key){let e=n.project_id||process.env.FIREBASE_PROJECT_ID,t=n.client_email,r=String(n.private_key).replace(/\\n/g,"\n");if(e&&t&&r)return{projectId:e,clientEmail:t,privateKey:r}}let i=process.env.FIREBASE_PROJECT_ID||process.env.GOOGLE_CLOUD_PROJECT||process.env.GCLOUD_PROJECT,a=process.env.FIREBASE_CLIENT_EMAIL,o=(process.env.FIREBASE_PRIVATE_KEY||"").replace(/\\n/g,"\n");if(!i||!a||!o)throw Error("Firebase Admin credentials not found. Set GOOGLE_APPLICATION_CREDENTIALS_JSON to the FULL service account JSON   (or) FIREBASE_SERVICE_ACCOUNT_BASE64 with the JSON base64-encoded,   (or) FIREBASE_PROJECT_ID + FIREBASE_CLIENT_EMAIL + FIREBASE_PRIVATE_KEY.");return{projectId:i,clientEmail:a,privateKey:o}}()),t=0===(0,i.getApps)().length?(0,i.initializeApp)({credential:e}):(0,i.getApp)(),r=(0,a.getFirestore)(t),n=(0,o.getAuth)(t);return{app:t,db:r,auth:n}}()),e[l]})();n()}catch(e){n(e)}})},9106:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{default:()=>s});var i=r(535),a=r(9637),o=e([i,a]);async function s(e,t){if("POST"!==e.method)return t.setHeader("Allow","POST"),t.status(405).json({error:"Method not allowed"});let r=e.headers["x-admin-api-key"]||(e.headers.authorization?.startsWith("Bearer ")?e.headers.authorization.slice(7):void 0);if(!process.env.ADMIN_API_KEY||r!==process.env.ADMIN_API_KEY)return t.status(401).json({error:"Unauthorized"});let{uid:n,email:i}=e.body||{};if(!n&&!i)return t.status(400).json({error:"Provide uid or email"});try{let e=n;if(!e&&i&&(e=(await (0,a.getAuth)().getUserByEmail(i)).uid),!e)return t.status(404).json({error:"User not found"});return await (0,a.getAuth)().setCustomUserClaims(e,{admin:!0}),t.status(200).json({ok:!0,uid:e})}catch(e){return console.error("makeAdmin error:",e),t.status(500).json({error:e?.message||"Internal error"})}}[i,a]=o.then?(await o)():o,n()}catch(e){n(e)}})},7153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,t,r)=>{e.exports=r(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=8933);module.exports=r})();