"use strict";(()=>{var e={};e.id=837,e.ids=[837],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3263:e=>{e.exports=import("firebase-admin/app")},9637:e=>{e.exports=import("firebase-admin/auth")},2929:e=>{e.exports=import("firebase-admin/firestore")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},4911:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{config:()=>l,default:()=>u,routeModule:()=>c});var a=r(1802),o=r(7153),s=r(6249),i=r(4745),d=e([i]);i=(d.then?(await d)():d)[0];let u=(0,s.l)(i,"default"),l=(0,s.l)(i,"config"),c=new a.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/devSeed",pathname:"/api/devSeed",bundlePath:"",filename:""},userland:i});n()}catch(e){n(e)}})},535:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{default:()=>l});var a=r(3263),o=r(2929),s=r(9637),i=e([a,o,s]);function d(e){if(!e)return null;try{let t=Buffer.from(e,"base64").toString("utf8");return JSON.parse(t)}catch{return null}}[a,o,s]=i.then?(await i)():i;let u="__taktr_admin__",l=(()=>{let e=globalThis;return e[u]||(e[u]=function(){let e=(0,a.cert)(function(){let e=process.env.GOOGLE_APPLICATION_CREDENTIALS_JSON,t=function(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}(e)||d(e||"");if(t&&t.client_email&&t.private_key){let e=t.project_id||process.env.FIREBASE_PROJECT_ID,r=t.client_email,n=String(t.private_key).replace(/\\n/g,"\n");if(e&&r&&n)return{projectId:e,clientEmail:r,privateKey:n}}let r=process.env.FIREBASE_SERVICE_ACCOUNT_BASE64||process.env.FIREBASE_PRIVATE_KEY_BASE64,n=d(r||"");if(n&&n.client_email&&n.private_key){let e=n.project_id||process.env.FIREBASE_PROJECT_ID,t=n.client_email,r=String(n.private_key).replace(/\\n/g,"\n");if(e&&t&&r)return{projectId:e,clientEmail:t,privateKey:r}}let a=process.env.FIREBASE_PROJECT_ID||process.env.GOOGLE_CLOUD_PROJECT||process.env.GCLOUD_PROJECT,o=process.env.FIREBASE_CLIENT_EMAIL,s=(process.env.FIREBASE_PRIVATE_KEY||"").replace(/\\n/g,"\n");if(!a||!o||!s)throw Error("Firebase Admin credentials not found. Set GOOGLE_APPLICATION_CREDENTIALS_JSON to the FULL service account JSON   (or) FIREBASE_SERVICE_ACCOUNT_BASE64 with the JSON base64-encoded,   (or) FIREBASE_PROJECT_ID + FIREBASE_CLIENT_EMAIL + FIREBASE_PRIVATE_KEY.");return{projectId:a,clientEmail:o,privateKey:s}}()),t=0===(0,a.getApps)().length?(0,a.initializeApp)({credential:e}):(0,a.getApp)(),r=(0,o.getFirestore)(t),n=(0,s.getAuth)(t);return{app:t,db:r,auth:n}}()),e[u]})();n()}catch(e){n(e)}})},4745:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{default:()=>s});var a=r(535),o=e([a]);async function s(e,t){try{let r=e.query.secret;if(!r||r!==process.env.DEV_SEED_SECRET)return t.status(401).json({error:"Unauthorized (bad secret)"});let{db:n,auth:o}=a.default,s=("POST"===e.method?e.body?.projectId:e.query.projectId)?.trim()||"demo-project",i=("POST"===e.method?e.body?.adminEmail:e.query.adminEmail)?.trim()||"mfurry@theyardlab.com",d=(await o.getUserByEmail(i)).uid,u=n.collection("projects").doc(s);await u.set({name:"Seeded Demo Project",ownerId:d,members:{[d]:!0},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{merge:!0});let l=u.collection("meta").doc("takt");await l.set({zones:["North Wing","South Wing","East Wing","West Wing"],trades:["Concrete","Framing","MEP","Drywall","Painting"],taktTimeDays:5,updatedAt:new Date().toISOString(),updatedBy:d},{merge:!0});let c=u.collection("tasks"),E=new Date,p=E.getFullYear(),m=E.getMonth(),g=e=>new Date(p,m,e).toISOString(),_=[{name:"Excavate footings",zone:"North Wing",trade:"Concrete",status:"done",startDate:g(1),endDate:g(3),plannedHours:24,actualHours:20},{name:"Pour footings",zone:"North Wing",trade:"Concrete",status:"done",startDate:g(4),endDate:g(5),plannedHours:16,actualHours:18},{name:"Form walls",zone:"South Wing",trade:"Concrete",status:"in-progress",startDate:g(6),endDate:g(8),plannedHours:24,actualHours:10},{name:"Frame level 1",zone:"South Wing",trade:"Framing",status:"in-progress",startDate:g(9),endDate:g(14),plannedHours:40,actualHours:12},{name:"MEP rough-in",zone:"East Wing",trade:"MEP",status:"not-started",startDate:g(15),endDate:g(20),plannedHours:48},{name:"Hang drywall",zone:"West Wing",trade:"Drywall",status:"not-started",startDate:g(21),endDate:g(25),plannedHours:40},{name:"Prime & paint",zone:"West Wing",trade:"Painting",status:"not-started",startDate:g(26),endDate:g(28),plannedHours:24},{name:"Frame level 2",zone:"North Wing",trade:"Framing",status:"not-started",startDate:g(16),endDate:g(22),plannedHours:56},{name:"MEP inspection",zone:"East Wing",trade:"MEP",status:"not-started",startDate:g(23),endDate:g(23),plannedHours:8},{name:"Close walls",zone:"South Wing",trade:"Drywall",status:"not-started",startDate:g(24),endDate:g(29),plannedHours:40}],S=n.batch();for(let e of _){let t=c.doc();S.set(t,{...e,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),percentComplete:"done"===e.status?100:"in-progress"===e.status?50:0})}return await S.commit(),t.status(200).json({ok:!0,projectId:s,seededTasks:_.length})}catch(e){return console.error("devSeed error",e),t.status(500).json({error:e?.message||"server error"})}}a=(o.then?(await o)():o)[0],n()}catch(e){n(e)}})},7153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,t,r)=>{e.exports=r(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=4911);module.exports=r})();