"use strict";(()=>{var e={};e.id=837,e.ids=[837],e.modules={5877:e=>{e.exports=require("firebase-admin/auth")},2594:e=>{e.exports=require("firebase-admin/firestore")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},8717:(e,t,r)=>{r.r(t),r.d(t,{config:()=>l,default:()=>u,routeModule:()=>c});var n={};r.r(n),r.d(n,{default:()=>d});var a=r(1802),o=r(7153),s=r(6249),i=r(2091);async function d(e,t){try{let r=e.query.secret;if(!r||r!==process.env.DEV_SEED_SECRET)return t.status(401).json({error:"Unauthorized (bad secret)"});let{db:n,auth:a}=i.default,o=("POST"===e.method?e.body?.projectId:e.query.projectId)?.trim()||"demo-project",s=("POST"===e.method?e.body?.adminEmail:e.query.adminEmail)?.trim()||"mfurry@theyardlab.com",d=(await a.getUserByEmail(s)).uid,u=n.collection("projects").doc(o);await u.set({name:"Seeded Demo Project",ownerId:d,members:{[d]:!0},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{merge:!0});let l=u.collection("meta").doc("takt");await l.set({zones:["North Wing","South Wing","East Wing","West Wing"],trades:["Concrete","Framing","MEP","Drywall","Painting"],taktTimeDays:5,updatedAt:new Date().toISOString(),updatedBy:d},{merge:!0});let c=u.collection("tasks"),E=new Date,p=E.getFullYear(),m=E.getMonth(),g=e=>new Date(p,m,e).toISOString(),_=[{name:"Excavate footings",zone:"North Wing",trade:"Concrete",status:"done",startDate:g(1),endDate:g(3),plannedHours:24,actualHours:20},{name:"Pour footings",zone:"North Wing",trade:"Concrete",status:"done",startDate:g(4),endDate:g(5),plannedHours:16,actualHours:18},{name:"Form walls",zone:"South Wing",trade:"Concrete",status:"in-progress",startDate:g(6),endDate:g(8),plannedHours:24,actualHours:10},{name:"Frame level 1",zone:"South Wing",trade:"Framing",status:"in-progress",startDate:g(9),endDate:g(14),plannedHours:40,actualHours:12},{name:"MEP rough-in",zone:"East Wing",trade:"MEP",status:"not-started",startDate:g(15),endDate:g(20),plannedHours:48},{name:"Hang drywall",zone:"West Wing",trade:"Drywall",status:"not-started",startDate:g(21),endDate:g(25),plannedHours:40},{name:"Prime & paint",zone:"West Wing",trade:"Painting",status:"not-started",startDate:g(26),endDate:g(28),plannedHours:24},{name:"Frame level 2",zone:"North Wing",trade:"Framing",status:"not-started",startDate:g(16),endDate:g(22),plannedHours:56},{name:"MEP inspection",zone:"East Wing",trade:"MEP",status:"not-started",startDate:g(23),endDate:g(23),plannedHours:8},{name:"Close walls",zone:"South Wing",trade:"Drywall",status:"not-started",startDate:g(24),endDate:g(29),plannedHours:40}],S=n.batch();for(let e of _){let t=c.doc();S.set(t,{...e,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),percentComplete:"done"===e.status?100:"in-progress"===e.status?50:0})}return await S.commit(),t.status(200).json({ok:!0,projectId:o,seededTasks:_.length})}catch(e){return console.error("devSeed error",e),t.status(500).json({error:e?.message||"server error"})}}let u=(0,s.l)(n,"default"),l=(0,s.l)(n,"config"),c=new a.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/devSeed",pathname:"/api/devSeed",bundlePath:"",filename:""},userland:n})},2091:(e,t,r)=>{r.d(t,{default:()=>d});let n=require("firebase-admin/app");var a=r(2594),o=r(5877);function s(e){if(!e)return null;try{let t=Buffer.from(e,"base64").toString("utf8");return JSON.parse(t)}catch{return null}}let i="__taktr_admin__",d=(()=>{let e=globalThis;return e[i]||(e[i]=function(){let e=(0,n.cert)(function(){let e=process.env.GOOGLE_APPLICATION_CREDENTIALS_JSON,t=function(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}(e)||s(e||"");if(t&&t.client_email&&t.private_key){let e=t.project_id||process.env.FIREBASE_PROJECT_ID,r=t.client_email,n=String(t.private_key).replace(/\\n/g,"\n");if(e&&r&&n)return{projectId:e,clientEmail:r,privateKey:n}}let r=s(process.env.FIREBASE_SERVICE_ACCOUNT_BASE64||process.env.FIREBASE_PRIVATE_KEY_BASE64||"");if(r&&r.client_email&&r.private_key){let e=r.project_id||process.env.FIREBASE_PROJECT_ID,t=r.client_email,n=String(r.private_key).replace(/\\n/g,"\n");if(e&&t&&n)return{projectId:e,clientEmail:t,privateKey:n}}let n=process.env.FIREBASE_PROJECT_ID||process.env.GOOGLE_CLOUD_PROJECT||process.env.GCLOUD_PROJECT,a=process.env.FIREBASE_CLIENT_EMAIL,o=(process.env.FIREBASE_PRIVATE_KEY||"").replace(/\\n/g,"\n");if(!n||!a||!o)throw Error("Firebase Admin credentials not found. Set GOOGLE_APPLICATION_CREDENTIALS_JSON to the FULL service account JSON   (or) FIREBASE_SERVICE_ACCOUNT_BASE64 with the JSON base64-encoded,   (or) FIREBASE_PROJECT_ID + FIREBASE_CLIENT_EMAIL + FIREBASE_PRIVATE_KEY.");return{projectId:n,clientEmail:a,privateKey:o}}()),t=0===(0,n.getApps)().length?(0,n.initializeApp)({credential:e}):(0,n.getApp)(),r=(0,a.getFirestore)(t),i=(0,o.getAuth)(t);return{app:t,db:r,auth:i}}()),e[i]})()},7153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,t,r)=>{e.exports=r(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=8717);module.exports=r})();